<div class="container mx-auto pr-6 overflow-hidden">
    <!-- Header Section -->
    <div class="flex justify-between">
        <h1 class="font-semibold text-2xl leading-9">Follow Up</h1>
        <div class="flex justify-between items-center">
            <app-search [keysArray]="keysArray" (searchEvent)="onSearchEvent($event)"></app-search>
            <button (click)="openModal()"
                class="rounded-lg secondaryBorder secondaryTxt px-4 py-3 flex items-center justify-center gap-2">
                Create Follow Up
            </button>
        </div>
    </div>

    <!-- Table Section -->
    <div class="mt-5 overflow-x-auto rounded-2xl border border-[#BDBDBD]">
        <table class="w-full bg-[#EBEBEB] text-left text-[#6F6F6F]">
            <thead class="bg-[#EBEBEB] text-sm md:text-base border border-[#BDBDBD] border-t-0 border-l-0">
                <tr>
                    <th *ngFor="let header of headers"
                        class="py-3 px-4 min-w-[120px] whitespace-nowrap border border-[#EAECF0] border-t-0 border-l-0">
                        {{ header }}
                    </th>
                </tr>
            </thead>
            <tbody>
                <!-- No Data Row -->
                <tr *ngIf="followUps.length === 0">
                    <td [attr.colspan]="headers.length"
                        class="bg-white px-4 py-2 h-[72px] text-center border-t border-gray-300 text-xs md:text-sm">
                        No Data Found
                    </td>
                </tr>

                <!-- Data Rows -->
                <tr *ngFor="let row of followUps; let i = index"
                    [ngClass]="{'bg-[#F7F7F7]': i % 2 === 1, 'bg-white': i % 2 !== 1}"
                    class="border-t border-gray-300 text-xs md:text-sm">

                    <!-- Data Columns -->
                    <td *ngFor="let key of keys" class="py-5 px-4 border border-[#EAECF0] border-t-0 border-l-0">
                        {{ row[key] }}
                    </td>

                    <!-- Actions Column -->
<td class="py-5 px-4 border border-[#EAECF0] border-t-0 border-l-0">
    <div class="flex space-x-4">
        <button *ngIf="row.actions?.delete !== false" (click)="deleteFollowUp(row)">
            <i class="fa-regular fa-trash-can"></i>
        </button>
        <button *ngIf="row.actions?.edit !== false" (click)="openModal(row.id)">
            <i class="fa-solid fa-pencil"></i>
        </button>
    </div>
</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Follow Up Modal -->
<div *ngIf="isModalVisible" class="fixed inset-0 z-50 flex justify-center items-center w-full h-full bg-black/50">
    <div class="relative bg-white w-[750px] max-h-[90vh] h-auto rounded-2xl p-12 gap-4 shadow-md overflow-y-auto">

        <!-- Close Icon -->
        <button (click)="closeModal()"
            class="absolute top-4 right-4 text-gray-400 hover:text-gray-900 transition duration-200">
            <i class="fa-solid fa-xmark text-2xl"></i>
        </button>

        <!-- Modal Header -->
        <h1 class="font-semibold text-2xl leading-9 mb-6">Create Follow Up</h1>

        <!-- Modal Content -->
        <div class="space-y-6">
            <!-- School and Grade -->
            <div class="grid grid-cols-2 gap-6">
                <div class="flex flex-col">
                    <label class="mb-1 primaryTxt" for="school">School</label>
                    <select id="school" [(ngModel)]="followUp.school"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg w-full p-2.5">
                        <option value="" disabled selected hidden>Choose School</option>
                        <option *ngFor="let school of schools" [value]="school">{{ school }}</option>
                    </select>
                </div>

                <div class="flex flex-col">
                    <label class="mb-1 primaryTxt" for="grade">Grade</label>
                    <select id="grade" [(ngModel)]="followUp.grade"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg w-full p-2.5">
                        <option value="" disabled selected hidden>Choose Grade</option>
                        <option *ngFor="let grade of grades" [value]="grade">{{ grade }}</option>
                    </select>
                </div>
            </div>

            <!-- Class and Student -->
            <div class="grid grid-cols-2 gap-6">
                <div class="flex flex-col">
                    <label class="mb-1 primaryTxt" for="class">Class</label>
                    <select id="class" [(ngModel)]="followUp.class"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg w-full p-2.5">
                        <option value="" disabled selected hidden>Choose Class</option>
                        <option *ngFor="let class of classes" [value]="class">{{ class }}</option>
                    </select>
                </div>

                <div class="flex flex-col">
                    <label class="mb-1 primaryTxt" for="student">Student</label>
                    <select id="student" [(ngModel)]="followUp.student"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg w-full p-2.5">
                        <option value="" disabled selected hidden>Choose Student</option>
                        <option *ngFor="let student of students" [value]="student">{{ student }}</option>
                    </select>
                </div>
            </div>

            <!-- Complaints -->
            <div class="flex flex-col">
                <label class="mb-1 primaryTxt" for="complaints">Complaints</label>
                <textarea id="complaints" [(ngModel)]="followUp.complaints"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg w-full p-2.5 h-24"
                    placeholder="Enter Complaints"></textarea>
            </div>

            <!-- Diagnosis -->
            <div class="flex flex-col">
                <label class="mb-1 primaryTxt" for="diagnosis">Diagnosis</label>
                <select id="diagnosis" [(ngModel)]="followUp.diagnosis"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg w-full p-2.5">
                    <option value="" disabled selected hidden>Choose Diagnosis</option>
                    <option *ngFor="let diagnosis of diagnoses" [value]="diagnosis">{{ diagnosis }}</option>
                </select>
            </div>

            <!-- Recommendation -->
            <div class="flex flex-col">
                <label class="mb-1 primaryTxt" for="recommendation">Recommendation</label>
                <textarea id="recommendation" [(ngModel)]="followUp.recommendation"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg w-full p-2.5 h-24"
                    placeholder="Enter Recommendation"></textarea>
            </div>

            <!-- Send SMS to Parent -->
            <div class="flex items-center gap-2">
                <input type="checkbox" id="sendSms" [(ngModel)]="followUp.sendSms"
                    class="w-4 h-4 rounded border-gray-300 text-[#FF7519] focus:ring-[#FF7519]">
                <label for="sendSms" class="text-sm text-gray-900">Send SMS to Parent</label>
            </div>
        </div>

        <!-- Save Button -->
        <div class="flex justify-end mt-6">
            <button class="secondaryBg text-white font-medium px-6 py-2 rounded-lg" (click)="saveFollowUp()">
                Save
            </button>
        </div>
    </div>
</div>